

<mat-card class="profile-card">
  <mat-card-content style="position: relative;">
    <form [formGroup]="profileForm" (ngSubmit)="onUpdateProfile()">
      <div class="profile-header">
        
        <div class="profile-image-container">
          <img [src]="imagePreviewUrl || currentProfileImageUrl" alt="Profile Image" class="profile-image">
          
          <div *ngIf="isEditMode" class="image-upload-overlay">
            <input type="file" #fileInput (change)="onFileSelected($event)" accept="image/*" hidden> 
            <button mat-mini-fab color="primary" type="button" (click)="fileInput.click()" aria-label="Upload profile image">
              <mat-icon class="small-icon">cloud_upload</mat-icon>
            </button>
          </div>
        </div>

        <div class="profile-actions">
          <button mat-mini-fab color="accent" type="button" (click)="toggleEditMode()" aria-label="Toggle edit mode">
            <mat-icon class="small-icon">{{ isEditMode ? 'cancel' : 'edit' }}</mat-icon>
          </button>
        </div>
      </div>
      
      <mat-form-field appearance="outline" class="full-width">
        <mat-label>Full Name</mat-label>
        <input matInput formControlName="name" readonly aria-readonly="true" required> 
        <mat-error *ngIf="profileForm.get('name')?.invalid && profileForm.get('name')?.touched">Name is required</mat-error>
      </mat-form-field>

      <mat-form-field appearance="outline" class="full-width">
        <mat-label>Email</mat-label>
        <input matInput formControlName="email" type="email" readonly aria-readonly="true">
      </mat-form-field>

      <mat-form-field appearance="outline" class="full-width"> 
        <mat-label>Bio</mat-label>
        <textarea matInput formControlName="bio" rows="2"></textarea> 
      </mat-form-field>

      <div class="bottom-info-actions">
        <p class="mat-body-1 last-login-info">
          {{ formatLastLogin(profileForm.get('lastLogin')?.value) }}
        </p>

        <mat-card-actions *ngIf="isEditMode" class="form-actions">
          <button mat-raised-button color="primary" type="submit" [disabled]="!isFormDirty()">
            <mat-icon>save</mat-icon> Save
          </button>
        </mat-card-actions>
      </div>
    </form>
  </mat-card-content>
</mat-card>